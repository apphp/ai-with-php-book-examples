<!DOCTYPE html>
<html>
<head>
    <title>Boston Housing Scatter Plot with Polynomial Regression</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Add regression-js for polynomial calculations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/regression/2.0.1/regression.min.js"></script>
</head>
<body>
<div style="width: 800px; height: 600px;">
    <canvas id="scatterChart"></canvas>
</div>

<script>
    // Data points
    const rawData = [
        {x: 6.575, y: 24.0}, {x: 6.421, y: 21.6}, {x: 7.185, y: 34.7},
        {x: 6.998, y: 33.4}, {x: 7.147, y: 36.2}, {x: 6.430, y: 28.7},
        {x: 6.012, y: 22.9}, {x: 6.172, y: 25.9}, {x: 5.631, y: 16.5},
        {x: 6.004, y: 18.9}, {x: 6.377, y: 16.6}, {x: 6.009, y: 18.9},
        {x: 5.889, y: 21.7}, {x: 5.949, y: 20.4}, {x: 6.096, y: 18.2},
        {x: 5.834, y: 19.9}, {x: 5.989, y: 23.2}, {x: 8.259, y: 38.8},
        {x: 8.183, y: 37.3}, {x: 7.853, y: 40.2}, {x: 7.255, y: 37.9},
        {x: 6.383, y: 28.1}, {x: 6.816, y: 31.6}, {x: 7.420, y: 38.7},
        {x: 7.685, y: 36.9}
    ];

    // Convert data for regression calculation
    const regressionData = rawData.map(point => [point.x, point.y]);

    // Calculate polynomial regression (degree 2)
    const result = regression.polynomial(regressionData, { order: 3 });
    const formula = result.string;
    const r2 = result.r2;

    // Generate points for the polynomial curve
    const minX = Math.min(...rawData.map(p => p.x));
    const maxX = Math.max(...rawData.map(p => p.x));
    const curvePoints = [];

    for(let x = minX; x <= maxX; x += 0.1) {
        curvePoints.push({
            x: x,
            y: result.predict(x)[1]
        });
    }

    // Create the scatter chart
    const ctx = document.getElementById('scatterChart').getContext('2d');
    new Chart(ctx, {
        data: {
            datasets: [{
                type: 'scatter',
                label: 'House Prices',
                data: rawData,
                backgroundColor: 'rgba(54, 162, 235, 0.6)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1,
                pointRadius: 6,
                pointHoverRadius: 8
            },
                {
                    type: 'line',
                    label: 'Polynomial Regression',
                    data: curvePoints,
                    borderColor: 'rgba(255, 99, 132, 1)',
                    backgroundColor: 'rgba(255, 99, 132, 0.1)',
                    borderWidth: 2,
                    pointRadius: 0,
                    fill: false
                }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                title: {
                    display: true,
                    text: [
                        'Boston Housing: Price vs Room Count',
                        `RÂ² = ${r2.toFixed(4)}`,
                        `Polynomial: ${formula}`
                    ],
                    font: {
                        size: 16
                    }
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            if (context.dataset.type === 'scatter') {
                                return `Rooms: ${context.parsed.x}, Price: $${context.parsed.y}k`;
                            }
                            return `Predicted Price: $${context.parsed.y.toFixed(1)}k`;
                        }
                    }
                }
            },
            scales: {
                x: {
                    title: {
                        display: true,
                        text: 'Number of Rooms'
                    },
                    grid: {
                        display: true,
                        drawBorder: true,
                        drawOnChartArea: true
                    }
                },
                y: {
                    title: {
                        display: true,
                        text: 'Price ($1000s)'
                    },
                    grid: {
                        display: true,
                        drawBorder: true,
                        drawOnChartArea: true
                    }
                }
            }
        }
    });
</script>
</body>
</html>
